(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{20:function(e,t,r){e.exports=r(32)},25:function(e,t,r){},30:function(e,t,r){},31:function(e,t,r){},32:function(e,t,r){"use strict";r.r(t);var n=r(0),i=r.n(n),s=r(5),a=r.n(s),u=(r(25),r(6)),c=r(7),l=r(10),o=r(8),d=r(11),p=r(9),m=function(e){return e.filter(function(e){return e.trips.length>0})},h=function(e){return function(t,r){var n=r().busSchedule.busArr,i={trips:[],id:n.length+1};t({type:"ON_TRIP_SELECT",payload:e}),(r().busSchedule.selectedTrip?r().busSchedule.selectedTrip.id:null)?n.push(i):n=m(n),t(function(e){return{type:"ON_ADD_PROVISIONAL_BUS",payload:e}}(n))}},T=function(e){return function(t,r){for(var n=r().busSchedule.tripsArr,i=r().busSchedule.busArr,s=r().busSchedule.busOfSelectedTrip,a=i[e],u={},c=r().busSchedule.selectedTrip?r().busSchedule.selectedTrip.id:"",l=0;l<n.length;l++)if(n[l].id===c){u=n[l];break}if(f(a,u)){t(function(e){return{type:"REJECT_ASSIGN_TRIP",payload:e}}(m(i)))}else{c&&(s.trips=s.trips.filter(function(e){return e.id!==c}),i[s.idx]=s),a.trips.push(u),i[e]=a;var o=i.filter(function(e){return e.trips&&0!==e.trips.length});t({type:"ACCEPT_ASSIGN_TRIP",payload:{busArr:o,targetBusIdx:e,selectedTripObj:u}})}}},f=function(e,t){var r=!1;if(e.id===t.busId)return r;for(var n=e.trips,i=0;i<n.length;i++)if(n[i].startTime<t.startTime&&n[i].endTime>t.startTime||n[i].startTime>=t.startTime&&n[i].endTime<=t.endTime||n[i].startTime<t.endTime&&n[i].endTime>t.endTime){r=!0;break}return r},b=function(e,t){var r=!1;return t.selectedTrip&&(r=e===t.selectedTrip),r},S=function(e){return i.a.createElement("div",{className:"BusRow ".concat(e.selectedTrip?"is-hoverable":""),onClick:function(){return e.onAssignTrip(e.busIdx)}},i.a.createElement("div",{className:"BusRow__left"},i.a.createElement("span",null,e.trips.length?"Bus: ".concat(e.busIdx+1):"New Bus"),e.trips&&e.trips.length?i.a.createElement("span",{className:"BusRow__time-window"},e.calculateTimeframe({trips:e.trips,timeframe:"earliest"})," ","-"," ",e.calculateTimeframe({trips:e.trips,timeframe:"latest"})," "):""),i.a.createElement("div",{className:"BusRow__right"},e.trips&&e.trips.length?e.trips.map(function(t,r){return i.a.createElement("div",{key:r,className:"BusRow__trip ".concat(b(t.id,e)?"is-selected":""),onClick:function(r){return e.onTripSelect(r,t.id,e.busIdx)},style:{left:t.startTime,width:e.calculateWidth(t.startTime,t.endTime)}},t.id)}):""))},_=function(e){return i.a.createElement("div",{className:"ScheduleTimeline__hour",style:{left:e.min}},e.hour||0===e.hour?"".concat(e.hour,":00"):"")},y=[{id:1,startTime:30,endTime:150},{id:2,startTime:180,endTime:300},{id:3,startTime:330,endTime:450},{id:4,startTime:40,endTime:130},{id:5,startTime:160,endTime:250},{id:6,startTime:280,endTime:370},{id:7,startTime:400,endTime:490},{id:8,startTime:80,endTime:240},{id:9,startTime:280,endTime:430}],E=(r(30),function(e){function t(){var e,r;Object(u.a)(this,t);for(var n=arguments.length,s=new Array(n),a=0;a<n;a++)s[a]=arguments[a];return(r=Object(l.a)(this,(e=Object(o.a)(t)).call.apply(e,[this].concat(s)))).calculateWidth=function(e,t){return t-e},r.calculateTimeframe=function(e){var t,r=[];return e.trips.forEach(function(t){r.push("earliest"===e.timeframe?t.startTime:t.endTime)}),e.timeframe,(t=Math.min.apply(Math,r))&&t!==1/0&&t!==-1/0&&(t=new Date(1e3*t).toISOString().substr(15,4)),t},r.onTripSelect=function(e,t,n){e.stopPropagation(),r.props.dispatch(h({id:t,busIdx:n}))},r.onAssignTrip=function(e){r.props.busSchedule.selectedTrip&&r.props.dispatch(T(e))},r.renderErrors=function(){return r.props.busSchedule.errors.length?i.a.createElement("p",{className:"BusSchedule__error"},r.props.busSchedule.errors[0]):""},r.renderTimeline=function(){return i.a.createElement("div",{className:"BusSchedule__timeline"},r.props.busSchedule.scheduleTimeInHours&&r.props.busSchedule.scheduleTimeInHours.map(function(e){return i.a.createElement(_,{key:e.hour,hour:e.hour,min:e.min})}))},r.renderBusRows=function(){var e=r.props.busSchedule.busArr;return e.length?e.map(function(t,n){return t.trips&&t.trips.length||n===e.length-1?i.a.createElement(S,{onTripSelect:r.onTripSelect,onAssignTrip:r.onAssignTrip,key:n,busIdx:n,id:t.id,selectedTrip:r.props.busSchedule.selectedTrip?r.props.busSchedule.selectedTrip.id:"",calculateWidth:r.calculateWidth,calculateTimeframe:r.calculateTimeframe,trips:t.trips}):""}):i.a.createElement("p",{className:"BusSchedule__message"},"No bus schedule data")},r}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e;this.props.dispatch((e=y,function(t){for(var r=[],n=[],i={},s=[{hour:0,min:0}],a=0;a<=720;)++a%60!==0&&0!==a||s.push({hour:a/60,min:a});e&&e.length&&e.forEach(function(e,t){e.busId=t+1,r.push(e),n.push({trips:[e],id:t+1})}),i.updatedTripsArr=r,i.busArr=n,i.scheduleTimeInHours=s,t({type:"ON_BUS_SCHEDULE_LOAD",payload:i})}))}},{key:"render",value:function(){return i.a.createElement("section",{className:"BusSchedule"},i.a.createElement("div",{className:"BusSchedule__inner"},this.renderTimeline(),this.renderBusRows(),this.renderErrors()))}}]),t}(n.Component)),A=Object(p.b)(function(e){return{busSchedule:e.busSchedule}})(E),v=(r(31),function(e){function t(){return Object(u.a)(this,t),Object(l.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{className:"AppBody"},i.a.createElement("header",{className:"AppBody__header"},i.a.createElement("h5",null,"Bus Scheduling")),i.a.createElement(A,null))}}]),t}(n.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var O=r(1),I=r(3),g={tripsArr:[],busArr:[],errors:[],selectedTrip:null},N=Object(O.c)({busSchedule:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ON_BUS_SCHEDULE_LOAD":return Object(I.a)({},e,{tripsArr:t.payload.updatedTripsArr,busArr:t.payload.busArr,scheduleTimeInHours:t.payload.scheduleTimeInHours});case"ON_TRIP_SELECT":var r,n=e.busArr[t.payload.busIdx];return r=e.selectedTrip&&t.payload.id===e.selectedTrip.id?null:t.payload,n.idx=t.payload.busIdx,Object(I.a)({},e,{selectedTrip:r,busOfSelectedTrip:n,errors:[]});case"ON_ADD_PROVISIONAL_BUS":return Object(I.a)({},e,{busArr:t.payload});case"ACCEPT_ASSIGN_TRIP":return Object(I.a)({},e,{busArr:t.payload.busArr,selectedTrip:null,errors:[]});case"REJECT_ASSIGN_TRIP":var i=e.errors;return i.push("A bus can only do one trip at a time. Try a different time slot."),Object(I.a)({},e,{selectedTrip:null,busArr:t.payload,errors:i});default:return e}}}),w=r(18),B=r(19),j=r.n(B),R=Object(O.a)(w.a,j.a),k=Object(O.d)(N,R);a.a.render(i.a.createElement(p.a,{store:k},i.a.createElement(v,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[20,1,2]]]);
//# sourceMappingURL=main.ed51683a.chunk.js.map